import React, { Component } from 'react'
import InlineSVG from 'svg-inline-react'
import Segment from 'segment-js';
import store from 'src/store';
import { mercureSubscribeSteps, setGameId } from 'src/store/reducer';
import {withRouter} from "react-router-dom";

class LoadingScreen extends Component {
    
    componentDidMount() {
        
        let { code } = this.props.match.params;
        store.dispatch(setGameId(code));
        store.dispatch(mercureSubscribeSteps());
    }
    render() {
        const logo = `<svg class="logo" version="1.1"
            id="svg3733" inkscape:version="0.92.4 (5da689c313, 2019-01-14)" sodipodi:docname="logo-miss-clock.svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:svg="http://www.w3.org/2000/svg"
            xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 760 250"
            style="enable-background:new 0 0 760 250;" xml:space="preserve">
            <style type="text/css">
                .st0{fill:#FFFDD8;}
                .st1{enable-background:new    ;}
                .st2{fill:transparent;}
            </style>
            <g id="g3731" transform="translate(0,41)">
                <path id="path3727" inkscape:connector-curvature="0" class="st0" d="M321.6,100c15,0,26.1,4.6,36.3,13.9c1.4,1.2,1.4,3,0.1,4.2
                    l-11.7,12.1c-1,1-2.7,1.1-3.7,0c0,0,0,0,0,0c-5.5-5-12.9-7.7-20.3-7.7c-17,0-29.4,14.1-29.4,30.9c0,16.6,12.6,30.4,29.5,30.4
                    c7,0,14.7-2.6,20.1-7.2c1-0.9,3-0.9,3.9,0.2l11.7,12.4c1,1.1,0.9,3-0.1,4.1c-10.2,9.9-23.1,14.6-36.5,14.6
                    c-30,0-54.1-23.9-54.1-53.8S291.6,100,321.6,100L321.6,100z M376,104.4c0-1.5,1.2-2.9,2.9-2.9h17.8c1.5,0,2.9,1.4,2.9,2.9v80.1
                    h35.7c1.6,0,2.9,1.4,2.9,2.9v16.4c0,1.5-1.2,2.9-2.9,2.9h-56.4c-1.6,0-2.9-1.4-2.9-2.9V104.4L376,104.4z M498.3,100
                    c30,0,54,24.1,54,54.1c0,30-24,53.8-54,53.8s-53.8-23.9-53.8-53.8C444.4,124.2,468.3,100,498.3,100L498.3,100z M498.3,184
                    c16.5,0,30-13.5,30-29.8c0-16.5-13.5-30.2-30-30.2c-16.4,0-29.9,13.7-29.9,30.2C468.4,170.5,481.9,184,498.3,184L498.3,184z
                    M616.9,100c15,0,26.1,4.6,36.3,13.9c1.3,1.2,1.3,3,0.2,4.2l-11.7,12.1c-1,1-2.7,1.1-3.7,0c0,0,0,0,0,0c-5.5-5-12.9-7.7-20.3-7.7
                    c-16.9,0-29.4,14.1-29.4,30.9c0,16.6,12.6,30.4,29.5,30.4c7,0,14.7-2.6,20.1-7.2c1-0.9,3-0.9,3.9,0.2l11.7,12.4
                    c1,1.1,0.9,3-0.2,4.1c-10.2,9.9-23.1,14.6-36.5,14.6c-30,0-54.1-23.9-54.1-53.8S586.9,100,616.9,100L616.9,100z M671.4,105.1
                    c0-2,1.5-3.6,3.6-3.6h17.5c2,0,3.6,1.7,3.6,3.6v39.4l33.3-41.6c0.6-0.8,2-1.5,2.8-1.5h18.9c2.9,0,4.4,3.3,2.7,5.6L718.8,151
                    l38.2,49.8c1.7,2.3,0,5.6-2.8,5.6h-20.7c-1,0-2.4-0.6-2.7-1.1l-34.6-47.1v44.7c0,1.9-1.7,3.6-3.6,3.6H675c-2.1,0-3.6-1.6-3.6-3.6
                    V105.1z M240.7,50.2c-15.8,0-28.4,12.7-28.4,28.6s12.6,28.4,28.4,28.4s28.5-12.6,28.5-28.4S256.5,50.2,240.7,50.2z M240.7,99.7
                    c-11.5,0-21-9.5-21-21c0-11.6,9.5-21.2,21-21.2c11.6,0,21.1,9.6,21.1,21.2C261.8,90.3,252.3,99.7,240.7,99.7L240.7,99.7z"/>
                <path id="path3729" inkscape:connector-curvature="0" class="st0" d="M240.7,101.8c-12.8,0-23.1-10.4-23.1-23.1
                    c0-4.8,1.5-9.6,4.4-13.5C208.9,55.6,192.7,50,175.2,50c-44.1,0-79.1,35.5-79.1,79.6c0,44.1,35,79.1,79.1,79.1
                    c44.1,0,79.4-35.1,79.4-79.1c0-10.4-1.9-20.3-5.5-29.3C246.4,101.3,243.6,101.8,240.7,101.8L240.7,101.8z M175.2,173.4
                    c-24,0-43.9-19.8-43.9-43.9c0-24.3,19.8-44.3,43.9-44.3c24.2,0,44.1,20.1,44.1,44.3C219.3,153.6,199.4,173.4,175.2,173.4
                    L175.2,173.4z"/>
                <g class="st1">
                    <path class="st2" id="test" stroke="rgb(255, 180, 0)" stroke-width="2px"   stroke-line-join="round" d="M51.3,113.8c-1.2-1-1.7-3.4-1.6-7.4c0.1-2.7,0.4-6.2,1-10.6c0.6-4.4,1.6-10.5,2.9-18.3
                        c2.3-14.4,4.2-26.7,5.6-37.1c0.8-6.5,1.3-11.8,1.4-16c0.1-3.9-1.1-5.4-3.5-4.4c-1.9,0.7-4.3,2.8-7.1,6.1
                        c-2.8,3.3-5.9,8.2-9.3,14.5c-1.1,2.1-2.3,3.3-3.5,3.8c-1,0.4-1.9,0.2-2.7-0.7c-0.8-0.9-1.1-2-1.1-3.5c0-1.4,0.3-2.9,0.8-4.5
                        c0.5-1.6,1.4-3.6,2.5-5.8c3.7-7.2,7.9-13.2,12.4-18.1c4.5-4.9,8.9-8.1,13.3-9.8c4.1-1.6,7.2-1.3,9.3,0.9c2.1,2.2,3.1,6.2,2.9,12
                        c-0.1,2.3-0.3,5.2-0.8,8.5c-0.5,3.3-0.9,6-1.2,8.1c-0.4,2.1-0.6,3.6-0.8,4.4C76.6,20,81.6,8.3,87.1,0.7C92.5-7,98.4-12,104.8-14.5
                        c4.9-1.9,8.6-1.4,11.3,1.6c2.7,2.9,3.9,8,3.7,15.3c-0.1,2.9-0.5,6.5-1.3,11.1c4.1-13.4,8.7-23.7,13.8-30.8
                        c5.1-7.1,11-11.9,17.5-14.5c5.2-2,9.2-1.6,11.9,1.2c2.7,2.8,3.9,7.7,3.7,14.8c-0.1,3.8-0.7,8.6-1.8,14.5l-7.9,39.8
                        c-0.9,4.6-1.3,8.5-1.4,11.6c-0.1,3.6,0.5,6.1,2,7.3c1.4,1.3,3.4,1.4,6,0.4c2.5-1,4.9-2.8,7.3-5.6c2.4-2.8,5.3-7.1,8.6-12.7
                        c0.9-1.6,2-2.6,3.1-3c1-0.4,1.7-0.1,2.3,0.7c0.5,0.8,0.8,2.1,0.7,4c-0.1,3.4-0.9,6.3-2.4,8.9c-4,7-8,12.4-11.9,16.4
                        c-3.9,4-7.9,6.8-12.1,8.4c-6.3,2.4-11.2,2.2-14.7-0.8c-3.5-3-5.1-8.2-4.9-15.5c0.1-5.1,1.2-12.9,3.3-23.3l5.1-25.5
                        c0.2-0.8,0.5-2.3,0.9-4.5c0.4-2.1,0.8-4.1,1.1-6c0.3-1.9,0.4-3.7,0.5-5.4c0.1-3-0.4-5.1-1.3-6.2c-1-1.1-2.4-1.3-4.2-0.6
                        c-3.5,1.4-7.3,5.4-11.2,12.1c-4,6.7-7.9,16.8-11.7,30.3c-3.8,13.5-7.1,30.3-9.8,50.6c-0.7,5.4-1.7,9.2-3,11.5
                        c-1.4,2.3-3.5,4-6.4,5.1c-2.5,1-4.4,1-5.5,0.1c-1.1-0.9-1.6-3.3-1.5-7.1c0.1-3.6,0.6-8.4,1.6-14.5c1-6.1,2.2-13.3,3.7-21.6
                        c4-22.3,6.1-36.5,6.3-42.6c0.1-3.3-0.4-5.5-1.4-6.7c-1-1.1-2.6-1.3-4.8-0.5C96.2,5.2,92.4,9,88.3,15.4c-4,6.3-8,16.3-12.1,30
                        c-4,13.7-7.6,31.5-10.6,53.3c-0.6,4.6-1.5,8-2.6,10.1c-1.1,2.1-3,3.7-6,4.9C54.4,114.7,52.4,114.8,51.3,113.8z"/>
                    <path class="st2"  stroke="rgb(255, 180, 0)" stroke-width="2px" stroke-line-join="round" d="M177.8,61.2c-2.1-3.1-3-8-2.9-14.6c0.1-3.9,0.7-9.1,1.7-15.5c1-6.4,2.3-12.6,3.8-18.4c0.8-3,1.7-5.3,2.8-6.8
                        c1.1-1.5,3-2.7,5.4-3.6c3.8-1.5,5.7-0.7,5.6,2.2c-0.1,2.2-0.9,7.5-2.5,15.9c-2.1,10.2-3.1,17-3.2,20.4c-0.1,2.6,0.2,4.5,0.7,5.6
                        c0.6,1.2,1.5,1.5,3,0.9c1.3-0.5,3.1-2.2,5.1-5.2c2.1-2.9,4.9-7.4,8.3-13.4c0.9-1.6,2-2.6,3.1-3c1-0.4,1.7-0.1,2.3,0.7
                        c0.5,0.8,0.8,2.1,0.7,4c-0.1,3.5-0.9,6.4-2.4,8.9c-7.7,13.3-14.7,21.2-21.2,23.7C183.4,64.9,179.9,64.3,177.8,61.2z M184.1-6.9
                        c-1.5-1.1-2.2-3.1-2.2-6.2c0.1-3,1.2-6,3.3-8.8c2.1-2.8,4.7-4.8,7.8-6c2.8-1.1,5-1.1,6.7-0.3c1.7,0.9,2.5,2.8,2.4,5.6
                        c-0.1,3.5-1.1,6.6-3.1,9.4c-2,2.8-4.6,4.8-7.8,6C187.9-5.9,185.6-5.8,184.1-6.9z"/>
                    <path class="st2"  stroke="rgb(255, 180, 0)" stroke-width="2px" stroke-line-join="round" d="M213.9,52.9c-2-1.3-3-3.2-2.9-5.8c0.1-2.3,0.8-4.5,2.3-6.7c1.5-2.2,3.6-3.8,6.3-4.9c1-0.4,2.1-0.7,3.4-1
                        c1.3-0.3,2.3-0.5,3-0.7c0-2.2-0.4-4.2-1.1-5.9c-0.7-1.7-1.7-3.2-2.8-4.6c-1.1-1.4-2.2-2.6-3.2-3.6c-2.5,6-4.9,11.1-7.2,15.4
                        c-2.4,4.3-4.9,8.4-7.7,12.5c-1.4,2.1-2.8,3.4-4.3,4c-1.2,0.5-2.2,0.3-2.9-0.4c-0.7-0.7-1.1-1.8-1-3.3c0-1.7,0.6-3.5,1.7-5.4
                        l1.5-2.6c4.3-7.5,7.5-13.5,9.7-18.1c1.3-3,2.9-6.9,4.8-11.8c1.8-4.9,3.6-9.9,5.4-15c1.5-4.4,4.5-7.4,9-9.1c2.1-0.8,3.5-1.2,4.3-1
                        c0.8,0.1,1.2,0.7,1.2,1.6c0,0.5-0.2,1.4-0.5,2.6c-0.3,1.2-0.8,2.5-1.3,3.9c-1.4,3.6-2.2,6.5-2.2,8.7c0,1.3,0.3,2.6,1.1,3.8
                        c0.7,1.3,1.9,2.7,3.5,4.4c2.3,2.7,4,5.1,5.2,7.2c1.2,2.1,1.7,4.6,1.6,7.7c0,0.9-0.1,2.1-0.3,3.7c3.7-3.1,8.1-9.1,13.2-18.1
                        c0.9-1.6,2-2.6,3.1-3c1-0.4,1.7-0.1,2.3,0.7c0.5,0.8,0.8,2.1,0.7,4c-0.1,3.3-0.9,6.3-2.4,8.9c-3.9,6.8-7.5,11.9-11,15.1
                        c-3.5,3.3-7.7,5.9-12.7,8c-3.1,4.1-6.7,6.9-10.8,8.5C218.9,54.1,215.9,54.2,213.9,52.9z"/>
                    <path class="st2"  stroke="rgb(255, 180, 0)" stroke-width="2px" stroke-line-join="round" d="M261.7,34.4c-2-1.3-3-3.2-2.9-5.8c0.1-2.3,0.8-4.5,2.3-6.7c1.5-2.2,3.6-3.8,6.3-4.9c1-0.4,2.1-0.7,3.4-1
                        c1.3-0.3,2.3-0.5,3-0.7c0-2.2-0.4-4.2-1.1-5.9c-0.7-1.7-1.7-3.2-2.8-4.6c-1.1-1.4-2.2-2.6-3.2-3.6c-2.5,6-4.9,11.1-7.2,15.4
                        c-2.4,4.3-4.9,8.4-7.7,12.5c-1.4,2.1-2.8,3.4-4.3,4c-1.2,0.5-2.2,0.3-2.9-0.4c-0.7-0.7-1.1-1.8-1-3.3c0-1.7,0.6-3.5,1.7-5.4
                        l1.5-2.6c4.3-7.5,7.5-13.5,9.7-18.1c1.3-3,2.9-6.9,4.8-11.8c1.8-4.9,3.6-9.9,5.4-15c1.5-4.4,4.5-7.4,9-9.1c2.1-0.8,3.5-1.2,4.3-1
                        c0.8,0.1,1.2,0.7,1.2,1.6c0,0.5-0.2,1.4-0.5,2.6c-0.3,1.2-0.8,2.5-1.3,3.9c-1.4,3.6-2.2,6.5-2.2,8.7c0,1.3,0.3,2.6,1.1,3.8
                        c0.7,1.3,1.9,2.7,3.5,4.4c2.3,2.7,4,5.1,5.2,7.2c1.2,2.1,1.7,4.6,1.6,7.7c0,0.9-0.1,2.1-0.3,3.7c3.7-3.1,8.1-9.1,13.2-18.1
                        c0.9-1.6,2-2.6,3.1-3c1-0.4,1.7-0.1,2.3,0.7c0.5,0.8,0.8,2.1,0.7,4c-0.1,3.3-0.9,6.3-2.4,8.9c-3.9,6.8-7.5,11.9-11,15.1
                        c-3.5,3.3-7.7,5.9-12.7,8c-3.1,4.1-6.7,6.9-10.8,8.5C266.7,35.6,263.7,35.7,261.7,34.4z"/>
                </g>
            </g>
        </svg>`;

        let done = (element) => () => {
            element.style.fill = "rgb(255, 180, 0)";
        }
        function loading() {
            
            let delay = 0;
            let letters = document.getElementsByClassName("st2");
            for(let segmentPath of letters) {
                segmentPath.style.fill = 'transparent'
            }
            for(let segmentPath of letters) {
                let segment = new Segment(segmentPath);
                segment.draw("100%", "0%", 1,  {circular:true, delay: delay, callback: done(segmentPath)});
                delay += 0.2;
            }
            
        }
        loading();
        setInterval(loading, 3000);
        return (
        <div className="view-loading">
                <InlineSVG src={logo} />
        </div>
        )
    }
}

export default withRouter(LoadingScreen);